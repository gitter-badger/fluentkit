{"version":3,"sources":["fluentkit.js"],"names":["System","register","_export","_context","_classCallCheck","instance","Constructor","TypeError","Polycast","Vue","mdl","routes","_createClass","vm","FluentKit","app","setters","_leemasonPolycast","_vue","_materialDesignLiteMaterial","_routes","execute","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","el","data","url","user","socket","loading","ready","this","document","querySelector","content","subscribeToGlobalNotifications","JSON","parse","subscribeToUserNotifications","componentHandler","upgradeDom","methods","subscribe","on","notification","message","timeout","$broadcast","bind","email","events","value","dispatch","event","callback","context","hasOwnProperty","push","tail","Array","slice","call","arguments","callbacks","l","undefined","apply"],"mappings":"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","file":"fluentkit.js","sourcesContent":["/*!\n * FluentKit v0.1.0\n * (c) 2016 Lee Mason\n * Released under the MIT License.\n */\nimport Polycast from 'leemason-polycast'\nimport Vue from 'vue'\nimport mdl from 'material-design-lite/material'\nimport routes from 'routes'\n\nlet vm = {\n    el: 'body',\n    data: {\n        url: '',\n        user: null,\n        socket: '',\n        loading: true,\n        routes: null\n    },\n    ready: function(){\n\n        this.routes = routes;\n\n        //get url\n        var url = document.querySelector('meta[name=\"url\"]');\n        this.url = url.content;\n\n        this.socket = new Polycast(this.url + '/polycast');\n\n        this.subscribeToGlobalNotifications();\n\n        var user = document.querySelector('meta[name=\"user\"]');\n        if(user != null) {\n            this.user = JSON.parse(user.content);\n\n            this.subscribeToUserNotifications();\n        }\n\n        //upgrade elements\n        mdl.componentHandler.upgradeDom();\n\n        //hide loader\n        this.loading = false;\n    },\n    methods: {\n        subscribeToGlobalNotifications: function(){\n            // fire global notifications down the tree\n            this.socket.subscribe('notifications').on('App\\\\Events\\\\Notification', function(data){\n                var notification = {message: data.message, timeout: 3000};\n                this.$broadcast('notification', notification);\n            }.bind(this));\n        },\n        subscribeToUserNotifications: function(){\n            // fire user notifications down the tree\n            this.socket.subscribe('user.' + this.user.email).on('App\\\\Events\\\\User\\\\Notification', function(data){\n                var notification = {message: data.message, timeout: 3000};\n                this.$broadcast('notification', notification);\n            }.bind(this));\n        }\n    }\n};\n\nclass FluentKit{\n\n    constructor(){\n        this.vm = null;\n\n        this.events = {};\n    }\n\n    start(){\n        if(this.vm != null){\n            return;\n        }\n        this.dispatch('beforeStart', this);\n        this.vm = new Vue(vm);\n        this.dispatch('afterStart', this);\n    }\n\n    vm(){\n        return this.vm;\n    }\n\n    on(event, callback, context){\n        this.events.hasOwnProperty(event) || (this.events[event] = []);\n        this.events[event].push([callback, context]);\n    }\n\n    dispatch(event, data){\n\n        this.events.hasOwnProperty(event) || (this.events[event] = []);\n\n        var tail = Array.prototype.slice.call(arguments, 1),\n            callbacks = this.events[event];\n        for(var i = 0, l = callbacks.length; i < l; i++) {\n            var callback = callbacks[i][0],\n                context = callbacks[i][1] === undefined ? this : callbacks[i][1];\n            callback.apply(context, tail);\n        }\n    }\n}\n\nvar app = new FluentKit();\n\nexport var app;\n\nexport default app;"],"sourceRoot":"/source/"}