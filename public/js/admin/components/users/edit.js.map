{"version":3,"sources":["admin/components/users/edit.js"],"names":["System","register","_export","_context","util","Vue","mdl","adminUsersEdit","setters","_util","_vue","_materialDesignLiteMaterial","execute","template","props","data","user","first_name","last_name","email","password","password_confirmation","roles","loading","ready","setTimeout","this","$http","get","$root","routes","route","id","include","then","response","forEach","role","push","name","status","message","timeout","$dispatch","bind","methods","triggerSave","payload","patch","put","rresponse","errors","formatValidationErrors","$setValidationErrors","component"],"mappings":"AAAA,YAEAA,QAAOC,UAAU,OAAQ,MAAO,iCAAkC,SAAUC,EAASC,GACjF,GAAIC,GAAMC,EAAKC,EAAKC,CACpB,QACIC,SAAU,SAAUC,GAAhBL,EAAAK,GAED,SAAUC,GADdL,EAAAK,EAAAA,YAGI,SAAUC,GAFdL,EAAAK,EAAAA,aAKCC,QAAS,WAHbL,GACAM,SAAU,6BACVC,OAAQ,MACRC,KAAM,WACF,OACIC,MACIC,WAAY,GACZC,UAAW,GACXC,MAAO,GACPC,SAAU,GACVC,sBAAuB,GACvBC,UAEJC,SAAS,IAGjBC,MAAO,WAEHC,WAAW,WACPC,KAAKC,MAAMC,IAAIF,KAAKG,MAAMC,OAAOC,MAAM,kBAAmBC,GAAIN,KAAKM,MAAOC,QAAS,UAAUC,KAAK,SAASC,GAEvGT,KAAKV,KAAOmB,EAASpB,KAAKC,IAFsF,IAK5GM,KACJI,MAAKV,KAAKM,MAAMc,QAAQ,SAASC,GAC7Bf,EAAMgB,KAAKD,EAAKE,QAGpBb,KAAKV,KAAKM,MAAQA,EAElBI,KAAKH,SAAU,GAEhB,SAASY,GAER,GAAuB,KAAnBA,EAASK,OAAe,CAExB,GAAIzB,IAAQ0B,QAASN,EAASpB,KAAM2B,QAAS,IAC7ChB,MAAKiB,UAAU,eAAgB5B,OAC9B,CAGD,GAAIA,IAAQ0B,QAAS,gGAAiGC,QAAS,IAC/HhB,MAAKiB,UAAU,eAAgB5B,GAInCW,KAAKH,SAAU,KAErBqB,KAAKlB,MAAO,MAGlBmB,SACIC,YAAa,WAETpB,KAAKH,SAAU,CAEf,IAAIwB,IACA9B,WAAYS,KAAKV,KAAKC,WACtBC,UAAWQ,KAAKV,KAAKE,UACrBC,MAAOO,KAAKV,KAAKG,MACjBC,SAAUM,KAAKV,KAAKI,SACpBC,sBAAuBK,KAAKV,KAAKK,sBAGrCK,MAAKC,MAAMqB,MAAMtB,KAAKG,MAAMC,OAAOC,MAAM,oBAAqBC,GAAIN,KAAKM,KAAMe,GAASb,KAAK,SAAUC,GAIjGT,KAAKC,MAAMsB,IAAIvB,KAAKG,MAAMC,OAAOC,MAAM,uBAAwBC,GAAIN,KAAKM,MAAOV,MAAOI,KAAKV,KAAKM,QAAQY,KAAK,SAASgB,GAElH,GAAInC,IAAQ0B,QAASN,EAASpB,KAAK0B,QAASC,QAAS,IAErDhB,MAAKiB,UAAU,eAAgB5B,GAE/BW,KAAKH,SAAU,GAEhB,SAAS2B,GACR,GAAwB,KAApBA,EAAUV,OAAe,CAGzB,GAAIW,GAAS/C,EAAKgD,uBAAuBF,EAAUnC,KAAKoC,OACxDzB,MAAK2B,qBAAqBF,OAExB,IAAwB,KAApBD,EAAUV,OAAe,CAE/B,GAAIzB,IAAQ0B,QAASS,EAAUnC,KAAM2B,QAAS,IAC9ChB,MAAKiB,UAAU,eAAgB5B,OAC9B,CAGD,GAAIA,IAAQ0B,QAAS,gGAAiGC,QAAS,IAC/HhB,MAAKiB,UAAU,eAAgB5B,GAInCW,KAAKH,SAAU,KAGpB,SAAUY,GAET,GAAuB,KAAnBA,EAASK,OAAe,CAGxB,GAAIW,GAAS/C,EAAKgD,uBAAuBjB,EAASpB,KAAKoC,OACvDzB,MAAK2B,qBAAqBF,OAExB,IAAuB,KAAnBhB,EAASK,OAAe,CAE9B,GAAIzB,IAAQ0B,QAASN,EAASpB,KAAM2B,QAAS,IAC7ChB,MAAKiB,UAAU,eAAgB5B,OAC9B,CAGD,GAAIA,IAAQ0B,QAAS,gGAAiGC,QAAS,IAC/HhB,MAAKiB,UAAU,eAAgB5B,GAInCW,KAAKH,SAAU,OACnBrB,EAAQ,UAMLG,EAAIiD,UAAU,mBAAoB/C","file":"admin/components/users/edit.js","sourcesContent":["/*!\n * FluentKit v0.1.0\n * (c) 2016 Lee Mason\n * Released under the MIT License.\n */\nimport * as util from 'util'\nimport Vue from 'vue'\nimport mdl from 'material-design-lite/material'\n\nvar adminUsersEdit = {\n    template: '#admin-users-edit-template',\n    props: ['id'],\n    data: function(){\n        return {\n            user: {\n                first_name: '',\n                last_name: '',\n                email: '',\n                password: '',\n                password_confirmation: '',\n                roles: []\n            },\n            loading: true\n        };\n    },\n    ready: function(){\n\n        setTimeout(function(){\n            this.$http.get(this.$root.routes.route('api.users.show', {id: this.id}), {include: 'roles'}).then(function(response){\n\n                this.user = response.data.user;\n\n                //reformat roles suitable for form\n                var roles = [];\n                this.user.roles.forEach(function(role){\n                    roles.push(role.name);\n                });\n\n                this.user.roles = roles;\n\n                this.loading = false;\n\n            }, function(response){\n\n                if (response.status == 401) {\n                    //something bad happened\n                    var data = {message: response.data, timeout: 3000};\n                    this.$dispatch('notification', data);\n                }else{\n\n                    //something bad happened\n                    var data = {message: 'We encountered a technical problem performing this request, please contact the administrator.', timeout: 3000};\n                    this.$dispatch('notification', data);\n\n                }\n\n                this.loading = false;\n            });\n        }.bind(this), 500);\n\n    },\n    methods: {\n        triggerSave: function(){\n\n            this.loading = true;\n\n            var payload = {\n                first_name: this.user.first_name,\n                last_name: this.user.last_name,\n                email: this.user.email,\n                password: this.user.password,\n                password_confirmation: this.user.password_confirmation\n            };\n\n            this.$http.patch(this.$root.routes.route('api.users.update', {id: this.id}), payload).then(function (response) {\n\n                // if we have success we should then update the permissions, use put instead of patch to ensure a full update\n\n                this.$http.put(this.$root.routes.route('api.users.roles.set', {id: this.id}), {roles: this.user.roles}).then(function(rresponse){\n\n                    var data = {message: response.data.message, timeout: 3000};\n\n                    this.$dispatch('notification', data);\n\n                    this.loading = false;\n\n                }, function(rresponse){\n                    if (rresponse.status == 422) {\n\n                        //validation/authorization error - set the errors as returned or clear\n                        var errors = util.formatValidationErrors(rresponse.data.errors);\n                        this.$setValidationErrors(errors);\n\n                    }else if (rresponse.status == 401) {\n                        //something bad happened\n                        var data = {message: rresponse.data, timeout: 3000};\n                        this.$dispatch('notification', data);\n                    }else{\n\n                        //something bad happened\n                        var data = {message: 'We encountered a technical problem performing this request, please contact the administrator.', timeout: 3000};\n                        this.$dispatch('notification', data);\n\n                    }\n\n                    this.loading = false;\n                });\n\n            }, function (response) {\n\n                if (response.status == 422) {\n\n                    //validation/authorization error - set the errors as returned or clear\n                    var errors = util.formatValidationErrors(response.data.errors);\n                    this.$setValidationErrors(errors);\n\n                }else if (response.status == 401) {\n                    //something bad happened\n                    var data = {message: response.data, timeout: 3000};\n                    this.$dispatch('notification', data);\n                }else{\n\n                    //something bad happened\n                    var data = {message: 'We encountered a technical problem performing this request, please contact the administrator.', timeout: 3000};\n                    this.$dispatch('notification', data);\n\n                }\n\n                this.loading = false;\n\n            });\n        }\n    }\n};\n\nexport default Vue.component('admin-users-edit', adminUsersEdit);\n\n//export default notifications"],"sourceRoot":"/source/"}